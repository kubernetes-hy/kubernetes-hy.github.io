{"componentChunkName":"component---src-templates-course-content-template-js","path":"/part-5/4-beyond-kubernetes","result":{"data":{"page":{"htmlAst":{"type":"element","tagName":"div","properties":{},"children":[{"type":"element","tagName":"text-box","properties":{"variant":"learningObjectives","name":"Learning Objectives"},"children":[{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"After this section you can"}]},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"List and compare platform options."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Setup a serverless platform (Knative) and deploy a simple workload"}]},{"type":"text","value":"\n"}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Finally as Kubernetes is a platform we'll go over a few popular building blocks that use Kubernetes."}]},{"type":"element","tagName":"blockquote","properties":{"className":["twitter-tweet"]},"children":[{"type":"element","tagName":"p","properties":{"lang":"en","dir":"ltr"},"children":[{"type":"text","value":"Kubernetes is a platform for building platforms. It's a better place to start; not the endgame."}]},{"type":"text","value":"â€” Kelsey Hightower (@kelseyhightower) "},{"type":"element","tagName":"a","properties":{"href":"https://twitter.com/kelseyhightower/status/935252923721793536?ref_src=twsrc%5Etfw"},"children":[{"type":"text","value":"November 27, 2017"}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"a","properties":{"href":"https://www.openshift.com/","target":"_blank","rel":["noopener","noreferrer"]},"children":[{"type":"text","value":"OpenShift"}]},{"type":"text","value":" is an \"enterprise\" Kubernetes ("},{"type":"element","tagName":"a","properties":{"href":"https://developers.redhat.com/products/openshift/overview","target":"_blank","rel":["noopener","noreferrer"]},"children":[{"type":"text","value":"Red Hat OpenShift Overview"}]},{"type":"text","value":"). Claiming that you don't have Kubernetes because you have OpenShift would be equal to claiming "},{"type":"element","tagName":"a","properties":{"href":"https://www.openshift.com/blog/enterprise-kubernetes-with-openshift-part-one","target":"_blank","rel":["noopener","noreferrer"]},"children":[{"type":"text","value":"\"I don't have an engine. I have a car!\""}]},{"type":"text","value":". For other options for production-ready Kubernetes see "},{"type":"element","tagName":"a","properties":{"href":"https://rancher.com/","target":"_blank","rel":["noopener","noreferrer"]},"children":[{"type":"text","value":"Rancher"}]},{"type":"text","value":", which you might have seen before in this page "},{"type":"element","tagName":"a","properties":{"href":"https://github.com/rancher/k3d","target":"_blank","rel":["noopener","noreferrer"]},"children":[{"type":"text","value":"https://github.com/rancher/k3d"}]},{"type":"text","value":", and "},{"type":"element","tagName":"a","properties":{"href":"https://cloud.google.com/anthos/gke","target":"_blank","rel":["noopener","noreferrer"]},"children":[{"type":"text","value":"Anthos GKE"}]},{"type":"text","value":", which might also sound familiar. They are all options when you're making the crucial decision between which Kubernetes distribution you want or would you like to use a managed service."}]},{"type":"element","tagName":"exercise","properties":{"name":"Exercise 5.04: Platform comparison"},"children":[{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"  Choose one service provider such as Rancher and compare it to another such as OpenShift."}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"  Decide arbitrarily which service provider is \"better\" and argue for it against the other service provider."}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"  For the submission a bullet point list is enough."}]}]},{"type":"element","tagName":"h3","properties":{"id":"serverless","style":"position:relative;"},"children":[{"type":"text","value":"Serverless"},{"type":"element","tagName":"a","properties":{"href":"#serverless","ariaLabel":"serverless permalink","className":["anchor","after"]},"children":[{"type":"element","tagName":"svg","properties":{"ariaHidden":"true","focusable":"false","height":"16","version":"1.1","viewBox":"0 0 16 16","width":"16"},"children":[{"type":"element","tagName":"path","properties":{"fillRule":"evenodd","d":"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"},"children":[]}]}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"a","properties":{"href":"https://en.wikipedia.org/wiki/Serverless_computing","target":"_blank","rel":["noopener","noreferrer"]},"children":[{"type":"text","value":"Serverless"}]},{"type":"text","value":" has gained a lot of popularity and it's easy to see why. Be it Google Cloud Run, Knative, OpenFaaS, OpenWhisk, Fission or Kubeless they're running on top of Kubernetes, or atleast capable of doing so. The older the serverless platform the more likely it won't be running on Kubernetes. As such a statement like \"Kubernetes is competing with serverless\" doesn't make much sense."}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"As this isn't a serverless course we won't go into depth about it but serverless sounds pretty dope. So next let's setup a serverless platform on our k3d because that's something we can do. For this let's choose "},{"type":"element","tagName":"a","properties":{"href":"https://knative.dev/","target":"_blank","rel":["noopener","noreferrer"]},"children":[{"type":"text","value":"Knative"}]},{"type":"text","value":" as it's the one "},{"type":"element","tagName":"a","properties":{"href":"https://cloud.google.com/blog/products/serverless/knative-based-cloud-run-services-are-ga","target":"_blank","rel":["noopener","noreferrer"]},"children":[{"type":"text","value":"Google Cloud Run"}]},{"type":"text","value":" is based on and seems to be a competent option compared to other open source options we have available. It also keeps us in the theme of platforms for platforms as it could be used to create your own serverless platform."}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Knative has its own community-backed "},{"type":"element","tagName":"a","properties":{"href":"https://github.com/knative/serving/blob/master/docs/runtime-contract.md","target":"_blank","rel":["noopener","noreferrer"]},"children":[{"type":"text","value":"runtime contract"}]},{"type":"text","value":". It describes what kind of features an application must and should have to run correctly as a FaaS. An essential requirement is that the app itself must be stateless and configurable with environmental variables. This kind of open-source specification helps a project gain wider adoption. For instance, "},{"type":"element","tagName":"a","properties":{"href":"https://ahmet.im/blog/cloud-run-is-a-knative/","target":"_blank","rel":["noopener","noreferrer"]},"children":[{"type":"text","value":"Google Cloud Run implemented"}]},{"type":"text","value":" the same contract."}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"We will follow "},{"type":"element","tagName":"a","properties":{"href":"https://knative.dev/docs/install/any-kubernetes-cluster/","target":"_blank","rel":["noopener","noreferrer"]},"children":[{"type":"text","value":"this guide"}]},{"type":"text","value":" to install \"Serving\" component of Knative. This will require us to choose a networking layer from the 6 offered. We will choose "},{"type":"element","tagName":"a","properties":{"href":"https://projectcontour.io/","target":"_blank","rel":["noopener","noreferrer"]},"children":[{"type":"text","value":"Contour"}]},{"type":"text","value":" since it's listed as being in "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"Stable"}]},{"type":"text","value":" state and the other Stable, Istio, has resource requirements that are quite large. For Contour and Knative to work locally in k3d we'll need to create our cluster without the traefik ingress."}]},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"console"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-console"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-console"]},"children":[{"type":"text","value":"$ k3d cluster create --port '8082:30080@agent[0]' -p 8081:80@loadbalancer --agents 2 --k3s-server-arg '--no-deploy=traefik'"}]}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Now installing Knative is pretty straight forward CRDs and core:"}]},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"console"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-console"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-console"]},"children":[{"type":"text","value":"$ kubectl apply -f https://github.com/knative/serving/releases/download/v0.18.0/serving-crds.yaml\n  ...\n\n$ kubectl apply -f https://github.com/knative/serving/releases/download/v0.18.0/serving-core.yaml\n  ..."}]}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"That's it. Well, if we wanted to run something that we would never access that is it. Next we'll install Contour."}]},{"type":"element","tagName":"h2","properties":{"id":"contour","style":"position:relative;"},"children":[{"type":"text","value":"Contour"},{"type":"element","tagName":"a","properties":{"href":"#contour","ariaLabel":"contour permalink","className":["anchor","after"]},"children":[{"type":"element","tagName":"svg","properties":{"ariaHidden":"true","focusable":"false","height":"16","version":"1.1","viewBox":"0 0 16 16","width":"16"},"children":[{"type":"element","tagName":"path","properties":{"fillRule":"evenodd","d":"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"},"children":[]}]}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Previously we used traefik for the job, but \""},{"type":"element","tagName":"a","properties":{"href":"https://github.com/traefik/traefik/issues/5081","target":"_blank","rel":["noopener","noreferrer"]},"children":[{"type":"text","value":"Traefik as Knative Ingress?"}]},{"type":"text","value":"\" is still an open issue."}]},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"console"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-console"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-console"]},"children":[{"type":"text","value":"$ kubectl apply -f https://github.com/knative/net-contour/releases/download/v0.18.0/contour.yaml \\\n                -f https://github.com/knative/net-contour/releases/download/v0.18.0/net-contour.yaml"}]}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"And configure Knative Serving to use Contour"}]},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"console"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-console"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-console"]},"children":[{"type":"text","value":"$ kubectl patch configmap/config-network \\\n  --namespace knative-serving \\\n  --type merge \\\n  --patch '{\"data\":{\"ingress.class\":\"contour.ingress.networking.knative.dev\"}}'"}]}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"And that's it. We'll leave the step 4 for configuring DNS out."}]},{"type":"element","tagName":"h4","properties":{"id":"hello-serverless-world","style":"position:relative;"},"children":[{"type":"text","value":"Hello Serverless World"},{"type":"element","tagName":"a","properties":{"href":"#hello-serverless-world","ariaLabel":"hello serverless world permalink","className":["anchor","after"]},"children":[{"type":"element","tagName":"svg","properties":{"ariaHidden":"true","focusable":"false","height":"16","version":"1.1","viewBox":"0 0 16 16","width":"16"},"children":[{"type":"element","tagName":"path","properties":{"fillRule":"evenodd","d":"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"},"children":[]}]}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"For testing purposes let's do a hello world from the Knative samples. In Knative there's another new resource called "},{"type":"element","tagName":"em","properties":{},"children":[{"type":"text","value":"Service"}]},{"type":"text","value":", not to be mixed up with the Kubernetes resource Service. These Services are used to manage the core Kubernetes resources"}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"knative-service.yaml"}]}]},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"yaml"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-yaml"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-yaml"]},"children":[{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"apiVersion"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" serving.knative.dev/v1\n"},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"kind"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" Service\n"},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"metadata"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"name"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" helloworld"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"go\n"},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"spec"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"template"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"metadata"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n      "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"name"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" helloworld"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"go"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"dwk"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"message"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"v1\n    "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"spec"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n      "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"containers"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n        "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"image"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" gcr.io/knative"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"samples/helloworld"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"go\n          "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"env"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n            "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"name"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" TARGET\n              "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"value"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"\"DwK\""}]}]}]}]},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"console"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-console"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-console"]},"children":[{"type":"text","value":"$ kubectl apply -f knative-service.yaml\n  service.serving.knative.dev/helloworld-go created"}]}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"As previously mentioned we don't have DNS so accessing the application isn't as easy. We'll have to set the Host parameter for our requests. Find out the host from:"}]},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"console"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-console"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-console"]},"children":[{"type":"text","value":"$ kubectl get ksvc\n  NAME            URL                                        LATESTCREATED                  LATESTREADY                    READY   REASON\n  helloworld-go   http://helloworld-go.default.example.com   helloworld-go-dwk-message-v1   helloworld-go-dwk-message-v1   True"}]}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"We'll need the URL field. Note also LATESTCREATED and LATESTREADY, they're revisions of the application. If we alter the knative-service.yaml it'll create new revisions where we could change between revisions."}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Now we can see that there are no pods running. There may be one as Knative spins one pod during the creation of the service, wait until no helloworld-go resources are found."}]},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"console"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-console"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-console"]},"children":[{"type":"text","value":"$ kubectl get po\n  No resources found in default namespace."}]}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"and when we send a request to the application"}]},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"console"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-console"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-console"]},"children":[{"type":"text","value":"$ curl -H \"Host: helloworld-go.default.example.com\" http://localhost:8081\n  Hello DwK!\n\n$ kubectl get po\n  NAME                                                       READY   STATUS    RESTARTS   AGE\n  helloworld-go-dwk-message-v1-deployment-6664bc858f-jqlv6   1/2     Running   0          6s"}]}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"it works and there are almost instantly pods ready."}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"If we wanted another service to access helloworld-go we would use the address "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"helloworld-go.default.svc.cluster.local"}]},{"type":"text","value":". Let's test this quickly with busybox by send a request from a busybox pod to our serverless helloworld:"}]},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"console"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-console"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-console"]},"children":[{"type":"text","value":"$ kubectl apply -f https://raw.githubusercontent.com/kubernetes/kubernetes/master/hack/testdata/recursive/pod/pod/busybox.yaml\n\n$ kubectl exec -it busybox1 -- wget -qO - helloworld-go.default.svc.cluster.local\n  Hello DwK!"}]}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Next let's test the revisions by changing the contents of the yaml and applying it."}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"knative-service.yaml"}]}]},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"yaml"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-yaml"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-yaml"]},"children":[{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"apiVersion"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" serving.knative.dev/v1\n"},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"kind"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" Service\n"},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"metadata"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"name"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" helloworld"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"go\n"},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"spec"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"template"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"metadata"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n      "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"name"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" helloworld"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"go"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"dwk"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"message"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"v2 "},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"# v2"}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"spec"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n      "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"containers"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n        "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"image"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" gcr.io/knative"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"samples/helloworld"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"go\n          "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"env"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n            "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"name"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" TARGET\n              "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"value"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"\"DwK-but-better\""}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"# Changed content"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"traffic"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"# traffic enables us to split traffic between multiple revisions!"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"revisionName"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" helloworld"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"go"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"dwk"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"message"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"v1\n    "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"percent"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"100"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"revisionName"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" helloworld"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"go"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"dwk"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"message"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"v2\n    "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"percent"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"0"}]}]}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"This created a new revision and edited the route. We can view the CRDs "},{"type":"element","tagName":"em","properties":{},"children":[{"type":"text","value":"Revision"}]},{"type":"text","value":" and "},{"type":"element","tagName":"em","properties":{},"children":[{"type":"text","value":"Route"}]},{"type":"text","value":"."}]},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"console"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-console"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-console"]},"children":[{"type":"text","value":"$ kubectl get revisions,routes\n  NAME                                                        CONFIG NAME     K8S SERVICE NAME               GENERATION   READY   REASON\n  revision.serving.knative.dev/helloworld-go-dwk-message-v1   helloworld-go   helloworld-go-dwk-message-v1   1            True\n  revision.serving.knative.dev/helloworld-go-dwk-message-v2   helloworld-go   helloworld-go-dwk-message-v2   2            True\n\n  NAME                                      URL                                        READY   REASON\n  route.serving.knative.dev/helloworld-go   http://helloworld-go.default.example.com   True"}]}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"So now when we send a request it's still the old message!"}]},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"console"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-console"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-console"]},"children":[{"type":"text","value":"$ curl -H \"Host: helloworld-go.default.example.com\" http://localhost:8081\n  Hello DwK!"}]}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Let's set the messages between v1 and v2 at 50% each and create a new revision with the best version!"}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"knative-service.yaml"}]}]},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"yaml"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-yaml"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-yaml"]},"children":[{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"apiVersion"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" serving.knative.dev/v1\n"},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"kind"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" Service\n"},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"metadata"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"name"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" helloworld"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"go\n"},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"spec"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"template"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"metadata"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n      "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"name"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" helloworld"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"go"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"dwk"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"message"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"v3 "},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"# v3"}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"spec"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n      "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"containers"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n        "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"image"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" gcr.io/knative"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"samples/helloworld"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"go\n          "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"env"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n            "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"name"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" TARGET\n              "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"value"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"\"DwK-but-extreme\""}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"# Changed content"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"traffic"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"# traffic enables us to split traffic between multiple revisions!"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"revisionName"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" helloworld"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"go"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"dwk"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"message"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"v1\n    "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"percent"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"50"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"revisionName"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" helloworld"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"go"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"dwk"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"message"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"v2\n    "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"percent"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"50"}]}]}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Now curling will result in 50% - 50% chance between the v1 and v2 messages. But accessing v3 is currently disabled. Let's add routing to v3 by defining a Route ourselves."}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"route.yaml"}]}]},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"yaml"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-yaml"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-yaml"]},"children":[{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"apiVersion"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" serving.knative.dev/v1\n"},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"kind"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" Route\n"},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"metadata"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"name"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" tester"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"route\n"},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"spec"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"traffic"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"revisionName"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" helloworld"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"go"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"dwk"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"message"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"v3\n      "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"percent"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"100"}]}]}]}]},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"console"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-console"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-console"]},"children":[{"type":"text","value":"$ kubectl apply -f route.yaml\n  route.serving.knative.dev/tester-route created\n\n$ kubectl get routes\n  NAME            URL                                        READY   REASON\n  helloworld-go   http://helloworld-go.default.example.com   True\n  tester-route    http://tester-route.default.example.com    True\n\n$ curl -H \"Host: tester-route.default.example.com\" http://localhost:8081\n  Hello DwK-but-extreme!"}]}]}]},{"type":"element","tagName":"exercise","properties":{"name":"Exercise 5.05: Deploy to Serverless"},"children":[{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"  Let's test serverless by making the pingpong application serverless."}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"  TIP: Your application should listen on port 8080 or better yet have a "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"PORT"}]},{"type":"text","value":" environment variable to configure this."}]}]},{"type":"element","tagName":"exercise","properties":{"name":"Exercise 5.06: Landscape"},"children":[{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"  Look at the CNCF Cloud Native Landscape "},{"type":"element","tagName":"a","properties":{"href":"https://landscape.cncf.io/images/landscape.png","target":"_blank","rel":["noopener","noreferrer"]},"children":[{"type":"text","value":"png"}]},{"type":"text","value":" (also available as "},{"type":"element","tagName":"a","properties":{"href":"https://landscape.cncf.io/","target":"_blank","rel":["noopener","noreferrer"]},"children":[{"type":"text","value":"interactive"}]},{"type":"text","value":")"}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"  Circle the logo of every product / project you've used. It does not have to be in this course. \"Used\" is defined here as something that was you knew that you were using it. Next use different color to circle those that something we used was depending on, except those that were already circled. Then create a list with information where they were used. Anything outside of this course context can be labeled as \"outside of the course\""}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"  For example:"}]},{"type":"element","tagName":"ol","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"I used "},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"HELM"}]},{"type":"text","value":" to install Prometheus in part 2."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"I indirectly used "},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"Flannel"}]},{"type":"text","value":" as k3d (through k3s) uses it. But I have no clue how it works."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"I've used "},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"Istio"}]},{"type":"text","value":" outside of the course."}]},{"type":"text","value":"\n"}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"  You can follow the indirect use as deep as you want, like in the k3d -> k3s -> flannel example, but use common sense to make the final image meaningful."}]}]},{"type":"element","tagName":"div","properties":{},"children":[{"type":"element","tagName":"quiz","properties":{"id":"ee5f4303-5634-4157-b928-cd8e2014220b"},"children":[]}]}]},"html":"<div><text-box variant='learningObjectives' name='Learning Objectives'><p>After this section you can</p><ul>\n<li>List and compare platform options.</li>\n<li>Setup a serverless platform (Knative) and deploy a simple workload</li>\n</ul></text-box><p>Finally as Kubernetes is a platform we'll go over a few popular building blocks that use Kubernetes.</p><blockquote class=\"twitter-tweet\"><p lang=\"en\" dir=\"ltr\">Kubernetes is a platform for building platforms. It&#39;s a better place to start; not the endgame.</p>&mdash; Kelsey Hightower (@kelseyhightower) <a href=\"https://twitter.com/kelseyhightower/status/935252923721793536?ref_src=twsrc%5Etfw\">November 27, 2017</a></blockquote><p><a href=\"https://www.openshift.com/\" target=\"_blank\" rel=\"noopener noreferrer\">OpenShift</a> is an \"enterprise\" Kubernetes (<a href=\"https://developers.redhat.com/products/openshift/overview\" target=\"_blank\" rel=\"noopener noreferrer\">Red Hat OpenShift Overview</a>). Claiming that you don't have Kubernetes because you have OpenShift would be equal to claiming <a href=\"https://www.openshift.com/blog/enterprise-kubernetes-with-openshift-part-one\" target=\"_blank\" rel=\"noopener noreferrer\">\"I don't have an engine. I have a car!\"</a>. For other options for production-ready Kubernetes see <a href=\"https://rancher.com/\" target=\"_blank\" rel=\"noopener noreferrer\">Rancher</a>, which you might have seen before in this page <a href=\"https://github.com/rancher/k3d\" target=\"_blank\" rel=\"noopener noreferrer\">https://github.com/rancher/k3d</a>, and <a href=\"https://cloud.google.com/anthos/gke\" target=\"_blank\" rel=\"noopener noreferrer\">Anthos GKE</a>, which might also sound familiar. They are all options when you're making the crucial decision between which Kubernetes distribution you want or would you like to use a managed service.</p><exercise name='Exercise 5.04: Platform comparison'><p>  Choose one service provider such as Rancher and compare it to another such as OpenShift.</p><p>  Decide arbitrarily which service provider is \"better\" and argue for it against the other service provider.</p><p>  For the submission a bullet point list is enough.</p></exercise><h3 id=\"serverless\" style=\"position:relative;\">Serverless<a href=\"#serverless\" aria-label=\"serverless permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3><p><a href=\"https://en.wikipedia.org/wiki/Serverless_computing\" target=\"_blank\" rel=\"noopener noreferrer\">Serverless</a> has gained a lot of popularity and it's easy to see why. Be it Google Cloud Run, Knative, OpenFaaS, OpenWhisk, Fission or Kubeless they're running on top of Kubernetes, or atleast capable of doing so. The older the serverless platform the more likely it won't be running on Kubernetes. As such a statement like \"Kubernetes is competing with serverless\" doesn't make much sense.</p><p>As this isn't a serverless course we won't go into depth about it but serverless sounds pretty dope. So next let's setup a serverless platform on our k3d because that's something we can do. For this let's choose <a href=\"https://knative.dev/\" target=\"_blank\" rel=\"noopener noreferrer\">Knative</a> as it's the one <a href=\"https://cloud.google.com/blog/products/serverless/knative-based-cloud-run-services-are-ga\" target=\"_blank\" rel=\"noopener noreferrer\">Google Cloud Run</a> is based on and seems to be a competent option compared to other open source options we have available. It also keeps us in the theme of platforms for platforms as it could be used to create your own serverless platform.</p><p>Knative has its own community-backed <a href=\"https://github.com/knative/serving/blob/master/docs/runtime-contract.md\" target=\"_blank\" rel=\"noopener noreferrer\">runtime contract</a>. It describes what kind of features an application must and should have to run correctly as a FaaS. An essential requirement is that the app itself must be stateless and configurable with environmental variables. This kind of open-source specification helps a project gain wider adoption. For instance, <a href=\"https://ahmet.im/blog/cloud-run-is-a-knative/\" target=\"_blank\" rel=\"noopener noreferrer\">Google Cloud Run implemented</a> the same contract.</p><p>We will follow <a href=\"https://knative.dev/docs/install/any-kubernetes-cluster/\" target=\"_blank\" rel=\"noopener noreferrer\">this guide</a> to install \"Serving\" component of Knative. This will require us to choose a networking layer from the 6 offered. We will choose <a href=\"https://projectcontour.io/\" target=\"_blank\" rel=\"noopener noreferrer\">Contour</a> since it's listed as being in <code class=\"language-text\">Stable</code> state and the other Stable, Istio, has resource requirements that are quite large. For Contour and Knative to work locally in k3d we'll need to create our cluster without the traefik ingress.</p><div class=\"gatsby-highlight\" data-language=\"console\"><pre class=\"language-console\"><code class=\"language-console\">$ k3d cluster create --port &#39;8082:30080@agent[0]&#39; -p 8081:80@loadbalancer --agents 2 --k3s-server-arg &#39;--no-deploy=traefik&#39;</code></pre></div><p>Now installing Knative is pretty straight forward CRDs and core:</p><div class=\"gatsby-highlight\" data-language=\"console\"><pre class=\"language-console\"><code class=\"language-console\">$ kubectl apply -f https://github.com/knative/serving/releases/download/v0.18.0/serving-crds.yaml\n  ...\n\n$ kubectl apply -f https://github.com/knative/serving/releases/download/v0.18.0/serving-core.yaml\n  ...</code></pre></div><p>That's it. Well, if we wanted to run something that we would never access that is it. Next we'll install Contour.</p><h2 id=\"contour\" style=\"position:relative;\">Contour<a href=\"#contour\" aria-label=\"contour permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2><p>Previously we used traefik for the job, but \"<a href=\"https://github.com/traefik/traefik/issues/5081\" target=\"_blank\" rel=\"noopener noreferrer\">Traefik as Knative Ingress?</a>\" is still an open issue.</p><div class=\"gatsby-highlight\" data-language=\"console\"><pre class=\"language-console\"><code class=\"language-console\">$ kubectl apply -f https://github.com/knative/net-contour/releases/download/v0.18.0/contour.yaml \\\n                -f https://github.com/knative/net-contour/releases/download/v0.18.0/net-contour.yaml</code></pre></div><p>And configure Knative Serving to use Contour</p><div class=\"gatsby-highlight\" data-language=\"console\"><pre class=\"language-console\"><code class=\"language-console\">$ kubectl patch configmap/config-network \\\n  --namespace knative-serving \\\n  --type merge \\\n  --patch &#39;{&quot;data&quot;:{&quot;ingress.class&quot;:&quot;contour.ingress.networking.knative.dev&quot;}}&#39;</code></pre></div><p>And that's it. We'll leave the step 4 for configuring DNS out.</p><h4 id=\"hello-serverless-world\" style=\"position:relative;\">Hello Serverless World<a href=\"#hello-serverless-world\" aria-label=\"hello serverless world permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h4><p>For testing purposes let's do a hello world from the Knative samples. In Knative there's another new resource called <em>Service</em>, not to be mixed up with the Kubernetes resource Service. These Services are used to manage the core Kubernetes resources</p><p><strong>knative-service.yaml</strong></p><div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">apiVersion</span><span class=\"token punctuation\">:</span> serving.knative.dev/v1\n<span class=\"token key atrule\">kind</span><span class=\"token punctuation\">:</span> Service\n<span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> helloworld<span class=\"token punctuation\">-</span>go\n<span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">template</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> helloworld<span class=\"token punctuation\">-</span>go<span class=\"token punctuation\">-</span>dwk<span class=\"token punctuation\">-</span>message<span class=\"token punctuation\">-</span>v1\n    <span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">containers</span><span class=\"token punctuation\">:</span>\n        <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">image</span><span class=\"token punctuation\">:</span> gcr.io/knative<span class=\"token punctuation\">-</span>samples/helloworld<span class=\"token punctuation\">-</span>go\n          <span class=\"token key atrule\">env</span><span class=\"token punctuation\">:</span>\n            <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> TARGET\n              <span class=\"token key atrule\">value</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"DwK\"</span></code></pre></div><div class=\"gatsby-highlight\" data-language=\"console\"><pre class=\"language-console\"><code class=\"language-console\">$ kubectl apply -f knative-service.yaml\n  service.serving.knative.dev/helloworld-go created</code></pre></div><p>As previously mentioned we don't have DNS so accessing the application isn't as easy. We'll have to set the Host parameter for our requests. Find out the host from:</p><div class=\"gatsby-highlight\" data-language=\"console\"><pre class=\"language-console\"><code class=\"language-console\">$ kubectl get ksvc\n  NAME            URL                                        LATESTCREATED                  LATESTREADY                    READY   REASON\n  helloworld-go   http://helloworld-go.default.example.com   helloworld-go-dwk-message-v1   helloworld-go-dwk-message-v1   True</code></pre></div><p>We'll need the URL field. Note also LATESTCREATED and LATESTREADY, they're revisions of the application. If we alter the knative-service.yaml it'll create new revisions where we could change between revisions.</p><p>Now we can see that there are no pods running. There may be one as Knative spins one pod during the creation of the service, wait until no helloworld-go resources are found.</p><div class=\"gatsby-highlight\" data-language=\"console\"><pre class=\"language-console\"><code class=\"language-console\">$ kubectl get po\n  No resources found in default namespace.</code></pre></div><p>and when we send a request to the application</p><div class=\"gatsby-highlight\" data-language=\"console\"><pre class=\"language-console\"><code class=\"language-console\">$ curl -H &quot;Host: helloworld-go.default.example.com&quot; http://localhost:8081\n  Hello DwK!\n\n$ kubectl get po\n  NAME                                                       READY   STATUS    RESTARTS   AGE\n  helloworld-go-dwk-message-v1-deployment-6664bc858f-jqlv6   1/2     Running   0          6s</code></pre></div><p>it works and there are almost instantly pods ready.</p><p>If we wanted another service to access helloworld-go we would use the address <code class=\"language-text\">helloworld-go.default.svc.cluster.local</code>. Let's test this quickly with busybox by send a request from a busybox pod to our serverless helloworld:</p><div class=\"gatsby-highlight\" data-language=\"console\"><pre class=\"language-console\"><code class=\"language-console\">$ kubectl apply -f https://raw.githubusercontent.com/kubernetes/kubernetes/master/hack/testdata/recursive/pod/pod/busybox.yaml\n\n$ kubectl exec -it busybox1 -- wget -qO - helloworld-go.default.svc.cluster.local\n  Hello DwK!</code></pre></div><p>Next let's test the revisions by changing the contents of the yaml and applying it.</p><p><strong>knative-service.yaml</strong></p><div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">apiVersion</span><span class=\"token punctuation\">:</span> serving.knative.dev/v1\n<span class=\"token key atrule\">kind</span><span class=\"token punctuation\">:</span> Service\n<span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> helloworld<span class=\"token punctuation\">-</span>go\n<span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">template</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> helloworld<span class=\"token punctuation\">-</span>go<span class=\"token punctuation\">-</span>dwk<span class=\"token punctuation\">-</span>message<span class=\"token punctuation\">-</span>v2 <span class=\"token comment\"># v2</span>\n    <span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">containers</span><span class=\"token punctuation\">:</span>\n        <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">image</span><span class=\"token punctuation\">:</span> gcr.io/knative<span class=\"token punctuation\">-</span>samples/helloworld<span class=\"token punctuation\">-</span>go\n          <span class=\"token key atrule\">env</span><span class=\"token punctuation\">:</span>\n            <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> TARGET\n              <span class=\"token key atrule\">value</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"DwK-but-better\"</span> <span class=\"token comment\"># Changed content</span>\n  <span class=\"token key atrule\">traffic</span><span class=\"token punctuation\">:</span> <span class=\"token comment\"># traffic enables us to split traffic between multiple revisions!</span>\n  <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">revisionName</span><span class=\"token punctuation\">:</span> helloworld<span class=\"token punctuation\">-</span>go<span class=\"token punctuation\">-</span>dwk<span class=\"token punctuation\">-</span>message<span class=\"token punctuation\">-</span>v1\n    <span class=\"token key atrule\">percent</span><span class=\"token punctuation\">:</span> <span class=\"token number\">100</span>\n  <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">revisionName</span><span class=\"token punctuation\">:</span> helloworld<span class=\"token punctuation\">-</span>go<span class=\"token punctuation\">-</span>dwk<span class=\"token punctuation\">-</span>message<span class=\"token punctuation\">-</span>v2\n    <span class=\"token key atrule\">percent</span><span class=\"token punctuation\">:</span> <span class=\"token number\">0</span></code></pre></div><p>This created a new revision and edited the route. We can view the CRDs <em>Revision</em> and <em>Route</em>.</p><div class=\"gatsby-highlight\" data-language=\"console\"><pre class=\"language-console\"><code class=\"language-console\">$ kubectl get revisions,routes\n  NAME                                                        CONFIG NAME     K8S SERVICE NAME               GENERATION   READY   REASON\n  revision.serving.knative.dev/helloworld-go-dwk-message-v1   helloworld-go   helloworld-go-dwk-message-v1   1            True\n  revision.serving.knative.dev/helloworld-go-dwk-message-v2   helloworld-go   helloworld-go-dwk-message-v2   2            True\n\n  NAME                                      URL                                        READY   REASON\n  route.serving.knative.dev/helloworld-go   http://helloworld-go.default.example.com   True</code></pre></div><p>So now when we send a request it's still the old message!</p><div class=\"gatsby-highlight\" data-language=\"console\"><pre class=\"language-console\"><code class=\"language-console\">$ curl -H &quot;Host: helloworld-go.default.example.com&quot; http://localhost:8081\n  Hello DwK!</code></pre></div><p>Let's set the messages between v1 and v2 at 50% each and create a new revision with the best version!</p><p><strong>knative-service.yaml</strong></p><div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">apiVersion</span><span class=\"token punctuation\">:</span> serving.knative.dev/v1\n<span class=\"token key atrule\">kind</span><span class=\"token punctuation\">:</span> Service\n<span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> helloworld<span class=\"token punctuation\">-</span>go\n<span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">template</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> helloworld<span class=\"token punctuation\">-</span>go<span class=\"token punctuation\">-</span>dwk<span class=\"token punctuation\">-</span>message<span class=\"token punctuation\">-</span>v3 <span class=\"token comment\"># v3</span>\n    <span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">containers</span><span class=\"token punctuation\">:</span>\n        <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">image</span><span class=\"token punctuation\">:</span> gcr.io/knative<span class=\"token punctuation\">-</span>samples/helloworld<span class=\"token punctuation\">-</span>go\n          <span class=\"token key atrule\">env</span><span class=\"token punctuation\">:</span>\n            <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> TARGET\n              <span class=\"token key atrule\">value</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"DwK-but-extreme\"</span> <span class=\"token comment\"># Changed content</span>\n  <span class=\"token key atrule\">traffic</span><span class=\"token punctuation\">:</span> <span class=\"token comment\"># traffic enables us to split traffic between multiple revisions!</span>\n  <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">revisionName</span><span class=\"token punctuation\">:</span> helloworld<span class=\"token punctuation\">-</span>go<span class=\"token punctuation\">-</span>dwk<span class=\"token punctuation\">-</span>message<span class=\"token punctuation\">-</span>v1\n    <span class=\"token key atrule\">percent</span><span class=\"token punctuation\">:</span> <span class=\"token number\">50</span>\n  <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">revisionName</span><span class=\"token punctuation\">:</span> helloworld<span class=\"token punctuation\">-</span>go<span class=\"token punctuation\">-</span>dwk<span class=\"token punctuation\">-</span>message<span class=\"token punctuation\">-</span>v2\n    <span class=\"token key atrule\">percent</span><span class=\"token punctuation\">:</span> <span class=\"token number\">50</span></code></pre></div><p>Now curling will result in 50% - 50% chance between the v1 and v2 messages. But accessing v3 is currently disabled. Let's add routing to v3 by defining a Route ourselves.</p><p><strong>route.yaml</strong></p><div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">apiVersion</span><span class=\"token punctuation\">:</span> serving.knative.dev/v1\n<span class=\"token key atrule\">kind</span><span class=\"token punctuation\">:</span> Route\n<span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> tester<span class=\"token punctuation\">-</span>route\n<span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">traffic</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">revisionName</span><span class=\"token punctuation\">:</span> helloworld<span class=\"token punctuation\">-</span>go<span class=\"token punctuation\">-</span>dwk<span class=\"token punctuation\">-</span>message<span class=\"token punctuation\">-</span>v3\n      <span class=\"token key atrule\">percent</span><span class=\"token punctuation\">:</span> <span class=\"token number\">100</span></code></pre></div><div class=\"gatsby-highlight\" data-language=\"console\"><pre class=\"language-console\"><code class=\"language-console\">$ kubectl apply -f route.yaml\n  route.serving.knative.dev/tester-route created\n\n$ kubectl get routes\n  NAME            URL                                        READY   REASON\n  helloworld-go   http://helloworld-go.default.example.com   True\n  tester-route    http://tester-route.default.example.com    True\n\n$ curl -H &quot;Host: tester-route.default.example.com&quot; http://localhost:8081\n  Hello DwK-but-extreme!</code></pre></div><exercise name='Exercise 5.05: Deploy to Serverless'><p>  Let's test serverless by making the pingpong application serverless.</p><p>  TIP: Your application should listen on port 8080 or better yet have a <code class=\"language-text\">PORT</code> environment variable to configure this.</p></exercise><exercise name='Exercise 5.06: Landscape'><p>  Look at the CNCF Cloud Native Landscape <a href=\"https://landscape.cncf.io/images/landscape.png\" target=\"_blank\" rel=\"noopener noreferrer\">png</a> (also available as <a href=\"https://landscape.cncf.io/\" target=\"_blank\" rel=\"noopener noreferrer\">interactive</a>)</p><p>  Circle the logo of every product / project you've used. It does not have to be in this course. \"Used\" is defined here as something that was you knew that you were using it. Next use different color to circle those that something we used was depending on, except those that were already circled. Then create a list with information where they were used. Anything outside of this course context can be labeled as \"outside of the course\"</p><p>  For example:</p><ol>\n<li>I used <strong>HELM</strong> to install Prometheus in part 2.</li>\n<li>I indirectly used <strong>Flannel</strong> as k3d (through k3s) uses it. But I have no clue how it works.</li>\n<li>I've used <strong>Istio</strong> outside of the course.</li>\n</ol><p>  You can follow the indirect use as deep as you want, like in the k3d -> k3s -> flannel example, but use common sense to make the final image meaningful.</p></exercise><div><quiz id=\"ee5f4303-5634-4157-b928-cd8e2014220b\"></quiz></div></div>","frontmatter":{"path":"/part-5/4-beyond-kubernetes","title":"Beyond Kubernetes"},"fileAbsolutePath":"/home/runner/work/kubernetes-hy.github.io/kubernetes-hy.github.io/data/part-5/4-beyond-kubernetes.md"},"allPages":{"edges":[{"node":{"id":"e4e5fe1c-25b1-57b3-87eb-e204e767a49c","frontmatter":{"path":"/faq","title":"FAQ"}}},{"node":{"id":"9f6e26aa-46a9-523d-96e4-a57c65ec083d","frontmatter":{"path":"/frontmatter-guide","title":"Frontmatter-guide"}}},{"node":{"id":"ecaa7011-87db-5ece-9b3c-1cfad638324a","frontmatter":{"path":"/","title":"Homepage"}}},{"node":{"id":"3d7eac33-2990-59d1-a002-64e0b0f4f370","frontmatter":{"path":"/known-problems-solutions","title":"Issues you may face"}}},{"node":{"id":"57c61ed7-37c4-5d0f-acd8-1dca0de6be4a","frontmatter":{"path":"/registration-and-completion","title":"Registration and Completion"}}},{"node":{"id":"ef82e5ba-97ba-51a5-ae2c-252b58c0c4f5","frontmatter":{"path":"/news-and-upcoming","title":"News and Upcoming"}}},{"node":{"id":"8ecc11b1-3298-589e-b97a-2a3a36861b8d","frontmatter":{"path":"/sanasto","title":"Sanasto"}}},{"node":{"id":"dab4b6a7-96cf-5efe-83f4-f5199c283e65","frontmatter":{"path":"/part-0","title":"Part 0"}}},{"node":{"id":"78948204-39a7-5f81-b9f4-3029400d5f82","frontmatter":{"path":"/part-1/2-introduction-to-debugging","title":"Introduction to Debugging"}}},{"node":{"id":"0b237cfb-5f2a-5d8e-9aa0-0cf9b045db3a","frontmatter":{"path":"/part-1/5-summary","title":"Summary"}}},{"node":{"id":"fe4a80ee-85ba-536e-bbf5-c5695399f40f","frontmatter":{"path":"/part-1","title":"Part 1"}}},{"node":{"id":"19841be9-897c-577a-9f82-5a7381bc073c","frontmatter":{"path":"/part-2/1-networking-between-pods","title":"Networking between pods"}}},{"node":{"id":"9e4ff8d0-2e6c-5d55-83a0-16ada460096d","frontmatter":{"path":"/part-2/2-organizing-a-cluster","title":"Organizing a cluster"}}},{"node":{"id":"0353d158-f751-57fd-94ce-373924da1b05","frontmatter":{"path":"/part-2/3-configuring-applications","title":"Configuring applications"}}},{"node":{"id":"eae6660d-1d18-527a-bc1c-0f2f7ab54c6d","frontmatter":{"path":"/part-2/4-statefulsets-and-jobs","title":"StatefulSets and Jobs"}}},{"node":{"id":"56f2a7a2-c9e2-5bbb-b6a7-76fd46592c69","frontmatter":{"path":"/part-2/5-monitoring","title":"Monitoring"}}},{"node":{"id":"f802a4ea-8d5a-503f-ad7b-d0138ab84c80","frontmatter":{"path":"/part-2/6-summary","title":"Summary"}}},{"node":{"id":"b810e0d9-0ac2-5073-a9dc-4ffd6649b7f7","frontmatter":{"path":"/part-2","title":"Part 2"}}},{"node":{"id":"40440141-c1a8-5723-858a-eea86119b5b6","frontmatter":{"path":"/part-3/4-summary","title":"Summary"}}},{"node":{"id":"708df9d2-30d1-518f-8066-80109a75c4dc","frontmatter":{"path":"/part-3","title":"Part 3"}}},{"node":{"id":"95ddb940-c020-59ea-8fc0-d043f61078be","frontmatter":{"path":"/part-4/3-summary","title":"Summary"}}},{"node":{"id":"c8b1eb5e-3c98-59b3-b6e9-6173791d7e34","frontmatter":{"path":"/part-4","title":"Part 4"}}},{"node":{"id":"8a2e40fa-1703-5755-aa66-ac69bf2e291d","frontmatter":{"path":"/part-5/3-service-mesh","title":"Service Mesh"}}},{"node":{"id":"7bebb01b-c990-5e7e-a9aa-d60f10ba63dd","frontmatter":{"path":"/part-5/5-summary","title":"Summary and end"}}},{"node":{"id":"cbd58376-8d52-5297-b38d-653179a1226f","frontmatter":{"path":"/part-5","title":"Part 5"}}},{"node":{"id":"e4c53dca-867f-5293-9b28-657b695cd3f3","frontmatter":{"path":"/part-1/3-introduction-to-networking","title":"Introduction to Networking"}}},{"node":{"id":"fd6ebeaa-c808-5f11-9bdc-30e4f69b8a2a","frontmatter":{"path":"/part-1/4-introduction-to-storage","title":"Introduction to Storage"}}},{"node":{"id":"9f3c6f02-668a-517b-b7b6-1828f74c7200","frontmatter":{"path":"/part-3/1-introduction-to-gke","title":"Introduction to Google Kubernetes Engine"}}},{"node":{"id":"e80b74e8-a23b-5d3c-808b-833a72ac739c","frontmatter":{"path":"/part-3/2-deployment-pipeline","title":"Deployment Pipeline"}}},{"node":{"id":"78f84327-bd7b-5b5d-941d-9fae8bca88d3","frontmatter":{"path":"/part-3/3-gke-features","title":"GKE features"}}},{"node":{"id":"f5314214-d779-5fb4-a19f-ab7442f3fbb2","frontmatter":{"path":"/part-4/2-messaging-systems","title":"Messaging Systems"}}},{"node":{"id":"aad60d2d-a38f-56d3-be5f-a1da31dcdfc2","frontmatter":{"path":"/part-4/extra-gitops","title":"Optional: GitOps"}}},{"node":{"id":"39fb03b7-2abe-515a-a543-b812fcbfdba5","frontmatter":{"path":"/part-5/1-kubernetes-internals","title":"Kubernetes Internals"}}},{"node":{"id":"a899eeb2-4329-5c9b-aadf-2fb803fa9142","frontmatter":{"path":"/part-5/2-custom-resource-definitions","title":"Custom Resource Definitions"}}},{"node":{"id":"471982cb-da12-5799-a6b2-fa8a3e67aa0d","frontmatter":{"path":"/part-5/4-beyond-kubernetes","title":"Beyond Kubernetes"}}},{"node":{"id":"da15a80e-5316-5986-afcf-75d521065017","frontmatter":{"path":"/part-1/1-first-deploy","title":"First Deploy"}}},{"node":{"id":"33c86b5c-3684-5006-b4e7-dbd0c7cc04bc","frontmatter":{"path":"/part-4/1-update-strategies-and-prometheus","title":"Update Strategies and Prometheus"}}}]}},"pageContext":{}},"staticQueryHashes":["3294351120","994120085"]}