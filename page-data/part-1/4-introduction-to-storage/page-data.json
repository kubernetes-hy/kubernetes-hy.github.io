{"componentChunkName":"component---src-templates-course-content-template-js","path":"/part-1/4-introduction-to-storage","result":{"data":{"page":{"htmlAst":{"type":"element","tagName":"div","properties":{},"children":[{"type":"element","tagName":"text-box","properties":{"variant":"learningObjectives","name":"Learning Objectives"},"children":[{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"After this section you"}]},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"are able to use volumes to share data between two containers in a pod"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"know about persistent volumes to store data on the disk of a node"}]},{"type":"text","value":"\n"}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"There are two things that are known to be difficult with Kubernetes. First is networking. Thankfully we can avoid most of the networking difficulties unless we were going to setup our own cluster. If you're interested you can watch this Webinar on \""},{"type":"element","tagName":"a","properties":{"href":"https://www.youtube.com/watch?v=GgCA2USI5iQ","target":"_blank","rel":["noopener","noreferrer"]},"children":[{"type":"text","value":"Kubernetes and Networks: Why is This So Dang Hard?"}]},{"type":"text","value":"\" but we'll skip most of the topics discussed in the video. The other of the most difficult things is "},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"storage"}]},{"type":"text","value":"."}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"In part 1 we will look into a very basic method of using storage and return to this topic later. Where almost everything else in Kubernetes is very much dynamic, moving between nodes and replicating with ease, storage does not have the same possibilities. \""},{"type":"element","tagName":"a","properties":{"href":"https://softwareengineeringdaily.com/2019/01/11/why-is-storage-on-kubernetes-is-so-hard/","target":"_blank","rel":["noopener","noreferrer"]},"children":[{"type":"text","value":"Why Is Storage On Kubernetes So Hard?"}]},{"type":"text","value":"\" provides us a wide angle on the difficulties and the different options we have to overcome them."}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"There are multiple types of volumes and we'll get started with two of them."}]},{"type":"element","tagName":"h3","properties":{"id":"volumes","style":"position:relative;"},"children":[{"type":"text","value":"Volumes"},{"type":"element","tagName":"a","properties":{"href":"#volumes","ariaLabel":"volumes permalink","className":["anchor","after"]},"children":[{"type":"element","tagName":"svg","properties":{"ariaHidden":"true","focusable":"false","height":"16","version":"1.1","viewBox":"0 0 16 16","width":"16"},"children":[{"type":"element","tagName":"path","properties":{"fillRule":"evenodd","d":"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"},"children":[]}]}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"A "},{"type":"element","tagName":"a","properties":{"href":"https://docs.docker.com/storage/volumes/","target":"_blank","rel":["noopener","noreferrer"]},"children":[{"type":"text","value":"volume"}]},{"type":"text","value":" in Docker and Docker compose is the way to persist the data the containers are using. With Kubernetes "},{"type":"element","tagName":"a","properties":{"href":"https://kubernetes.io/docs/concepts/storage/ephemeral-volumes/","target":"_blank","rel":["noopener","noreferrer"]},"children":[{"type":"text","value":"the simple volumes"}]},{"type":"text","value":" that is not quite the case."}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"The Kubernetes volumes, in technical terms "},{"type":"element","tagName":"em","properties":{},"children":[{"type":"text","value":"emptyDir"}]},{"type":"text","value":" volumes, are shared filesystems "},{"type":"element","tagName":"em","properties":{},"children":[{"type":"text","value":"inside a pod"}]},{"type":"text","value":", this means that their lifecycle is tied to a pod. When the pod is destroyed the data is lost. In addition, simply moving the pod from another node will destroy the contents of the volume as the space is reserved from the node the pod is running on. So surely you should not use "},{"type":"element","tagName":"a","properties":{"href":"https://kubernetes.io/docs/concepts/storage/volumes/#emptydir","target":"_blank","rel":["noopener","noreferrer"]},"children":[{"type":"text","value":"emptyDir"}]},{"type":"text","value":"volumes e.g. for backing up a database. Even with the limitations it may be used as a cache as it persists between container restarts or it can be used to share files between two containers in a pod."}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Before we can get started with this, we need an application that shares data with another application. In this case, it will work as a method to share simple log files with each other. We'll need to develop:"}]},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"App 1 that will check if /usr/src/app/files/image.jpg exists and if not, it downloads a random image and saves it as image.jpg. Any HTTP request will trigger a new image generation."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"App 2 that will check for the file /usr/src/app/files/image.jpg and shows it, if it is available."}]},{"type":"text","value":"\n"}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Apps share a deployment so that both of them are "},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"inside the same pod"}]},{"type":"text","value":". My version is available for you to use "},{"type":"element","tagName":"a","properties":{"href":"https://github.com/kubernetes-hy/material-example/blob/b9ff709b4af7ca13643635e07df7367b54f5c575/app3/manifests/deployment.yaml","target":"_blank","rel":["noopener","noreferrer"]},"children":[{"type":"text","value":"here"}]},{"type":"text","value":". The example includes ingress and service to access the application."}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"deployment.yaml"}]}]},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"yaml"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-yaml"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-yaml"]},"children":[{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"apiVersion"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" apps/v1\n"},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"kind"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" Deployment\n"},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"metadata"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"name"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" images"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"dep\n"},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"spec"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"replicas"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"1"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"selector"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"matchLabels"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n      "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"app"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" images\n  "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"template"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"metadata"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n      "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"labels"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n        "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"app"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" images\n    "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"spec"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n      "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"volumes"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"# Define volume"}]},{"type":"text","value":"\n        "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"name"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" shared"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"image\n          "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"emptyDir"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"text","value":"\n      "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"containers"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n        "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"name"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" image"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"finder\n          "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"image"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" jakousa/dwk"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"app3"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"image"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"finder"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"b7fc18de2376da80ff0cfc72cf581a9f94d10e64\n          "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"volumeMounts"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"# Mount volume"}]},{"type":"text","value":"\n          "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"name"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" shared"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"image\n            "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"mountPath"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" /usr/src/app/files\n        "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"name"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" image"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"response\n          "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"image"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" jakousa/dwk"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"app3"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"image"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"response"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"b7fc18de2376da80ff0cfc72cf581a9f94d10e64\n          "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"volumeMounts"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"# Mount volume"}]},{"type":"text","value":"\n          "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"name"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" shared"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"image\n            "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"mountPath"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" /usr/src/app/files"}]}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"As the display is dependent on the volume we can confirm that it works by accessing the image-response and getting the image. The provided ingress used the previously opened port 8081 "},{"type":"element","tagName":"a","properties":{"href":"http://localhost:8081","target":"_blank","rel":["noopener","noreferrer"]},"children":[{"type":"text","value":"http://localhost:8081"}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Note that all data is lost when the pod goes down."}]},{"type":"element","tagName":"exercise","properties":{"name":"Exercise 1.10: Even more services"},"children":[{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"  Split the \"Log output\" application into two different containers within a single pod:"}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"  One generates a new timestamp every 5 seconds and saves it into a file."}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"  The other reads that file and outputs it with a hash for the user to see."}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"  Either application can generate the hash. The reader or the writer."}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"  You may find "},{"type":"element","tagName":"a","properties":{"href":"https://kubernetes.io/docs/reference/kubectl/generated/kubectl_logs/","target":"_blank","rel":["noopener","noreferrer"]},"children":[{"type":"text","value":"this"}]},{"type":"text","value":" helpful now since there are more than one container running inside a pod."}]}]},{"type":"element","tagName":"h3","properties":{"id":"persistent-volumes","style":"position:relative;"},"children":[{"type":"text","value":"Persistent Volumes"},{"type":"element","tagName":"a","properties":{"href":"#persistent-volumes","ariaLabel":"persistent volumes permalink","className":["anchor","after"]},"children":[{"type":"element","tagName":"svg","properties":{"ariaHidden":"true","focusable":"false","height":"16","version":"1.1","viewBox":"0 0 16 16","width":"16"},"children":[{"type":"element","tagName":"path","properties":{"fillRule":"evenodd","d":"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"},"children":[]}]}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"In contrast to the emptyDir volumes, a "},{"type":"element","tagName":"a","properties":{"href":"https://kubernetes.io/docs/concepts/storage/persistent-volumes/","target":"_blank","rel":["noopener","noreferrer"]},"children":[{"type":"text","value":"Persistent Voulme"}]},{"type":"text","value":" is something you probably had in mind when we started talking about volumes."}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"A Persistent Volume (PV) is a cluster-wide resource, that represents a piece of storage in the cluster that has been provisioned by the cluster administrator or is "},{"type":"element","tagName":"a","properties":{"href":"https://kubernetes.io/docs/concepts/storage/dynamic-provisioning/","target":"_blank","rel":["noopener","noreferrer"]},"children":[{"type":"text","value":"dynamically"}]},{"type":"text","value":" provisioned. Persistent Volumes can be backed by various types of storage such as local disk, NFS, cloud storage, etc."}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"PVs have a lifecycle independent of any individual pod that uses the PV. This means that the data in the PV can outlive the pod that it was attached to."}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"When using a cloud provider, such as Google Kubernetes Engine which we shall use in parts 3 and 4, it is the cloud provider that takes care of backing storage and the Persistent Volumes that you can use. If you run your own cluster or use a local cluster such as k3s for development, you need to take care of the storage system and Persistent Volumes by yourself."}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"An easy option that we can use with K3s is a "},{"type":"element","tagName":"a","properties":{"href":"https://kubernetes.io/docs/concepts/storage/volumes/#local","target":"_blank","rel":["noopener","noreferrer"]},"children":[{"type":"text","value":"local"}]},{"type":"text","value":" PersistentVolume that uses a path in a cluster node as the storage. This solution ties the volume to a particular node and if the node becomes unavailable, the storage is not usable."}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"So the local Persistent Volumes are "},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"not"}]},{"type":"text","value":" the solution to be used in production!"}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"For the "},{"type":"element","tagName":"em","properties":{},"children":[{"type":"text","value":"PersistentVolume"}]},{"type":"text","value":" to work you first need to create the local path in the node we are binding it to. Since our cluster runs via Docker let's create a directory at "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"/tmp/kube"}]},{"type":"text","value":" in the container "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"k3d-k3s-default-agent-0"}]},{"type":"text","value":". This can simply be done via "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"docker exec k3d-k3s-default-agent-0 mkdir -p /tmp/kube"}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"The Persistent Volume definition is created as follows:"}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"persistentvolume.yaml"}]}]},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"yaml"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-yaml"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-yaml"]},"children":[{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"apiVersion"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" v1\n"},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"kind"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" PersistentVolume\n"},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"metadata"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"name"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" example"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"pv\n"},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"spec"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"storageClassName"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" my"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"example"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"pv "},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"# this is the name you are using later to claim this volume"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"capacity"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"storage"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" 1Gi "},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"# Could be e.q. 500Gi. Small amount is to preserve space when testing locally"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"volumeMode"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" Filesystem "},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"# This declares that it will be mounted into pods as a directory"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"accessModes"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":" ReadWriteOnce\n  "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"local"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"path"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" /tmp/kube\n  "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"nodeAffinity"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"## This is only required for local, it defines which nodes can access it"}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"required"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n      "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"nodeSelectorTerms"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n      "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"matchExpressions"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n        "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"key"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" kubernetes.io/hostname\n          "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"operator"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" In\n          "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"values"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n          "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":" k3d"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"k3s"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"default"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"agent"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"0"}]}]}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"a","properties":{"href":"https://kubernetes.io/docs/concepts/storage/persistent-volumes/","target":"_blank","rel":["noopener","noreferrer"]},"children":[{"type":"text","value":"Persistent Volume Claim"}]},{"type":"text","value":" (PVC) is a request for storage by a user."}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"When a user creates a PVC, Kubernetes finds an appropriate PV that satisfies the claim's requirements and binds them together. If no PV is available, depending on the configuration, the cluster might dynamically create a PV that meets the claim's needs."}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Once bound, the PersistentVolumeClaim is \"locked\" and can only be used by one Pod (depending on the access mode specified). This ensures that the PV resource is exclusively used by the pod it's bound to."}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"If there is no suitable Persistent Volume available, the PVC will stay in the \"Pending\" state, waiting for a suitable PV."}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Conceptually, you can think of PVs as the physical volume (the actual storage in your infrastructure), whereas PVCs are the means by which pods claim this storage for their use."}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Let us now create a claim for our app:"}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"persistentvolumeclaim.yaml"}]}]},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"yaml"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-yaml"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-yaml"]},"children":[{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"apiVersion"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" v1\n"},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"kind"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" PersistentVolumeClaim\n"},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"metadata"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"name"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" image"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"claim "},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"# name of ther volume claim, this will be used in the deployment"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"spec"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"storageClassName"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" my"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"example"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"pv "},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"# this is the name of the persisten volume we are claiming"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"accessModes"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":" ReadWriteOnce\n  "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"resources"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"requests"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n      "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"storage"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" 1Gi"}]}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Modify the previously introduced deployment to use it:"}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"deployment.yaml"}]}]},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"yaml"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-yaml"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-yaml"]},"children":[{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"# ..."}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"spec"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n      "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"volumes"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n        "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"name"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" shared"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"image\n          "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"persistentVolumeClaim"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n            "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"claimName"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" image"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"claim\n      "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"containers"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n        "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"name"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" image"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"finder\n          "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"image"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" jakousa/dwk"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"app3"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"image"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"finder"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"b7fc18de2376da80ff0cfc72cf581a9f94d10e64\n          "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"volumeMounts"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n          "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"name"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" shared"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"image\n            "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"mountPath"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" /usr/src/app/files\n        "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"name"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" image"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"response\n          "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"image"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" jakousa/dwk"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"app3"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"image"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"response"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"b7fc18de2376da80ff0cfc72cf581a9f94d10e64\n          "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"volumeMounts"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n          "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"name"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" shared"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"image\n            "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"mountPath"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" /usr/src/app/files"}]}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"And apply it with persistentvolume.yaml and persistentvolumeclaim.yaml."}]},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"console"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-console"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-console"]},"children":[{"type":"text","value":"$ kubectl apply -f https://raw.githubusercontent.com/kubernetes-hy/material-example/master/app3/manifests/deployment-persistent.yaml"}]}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"With the previous service and ingress, we can access the app in "},{"type":"element","tagName":"a","properties":{"href":"http://localhost:8081","target":"_blank","rel":["noopener","noreferrer"]},"children":[{"type":"text","value":"http://localhost:8081"}]},{"type":"text","value":". To confirm that the data is persistent we can run"}]},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"console"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-console"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-console"]},"children":[{"type":"text","value":"$ kubectl delete -f https://raw.githubusercontent.com/kubernetes-hy/material-example/master/app3/manifests/deployment-persistent.yaml\n  deployment.apps \"images-dep\" deleted\n$ kubectl apply -f https://raw.githubusercontent.com/kubernetes-hy/material-example/master/app3/manifests/deployment-persistent.yaml\n  deployment.apps/images-dep created"}]}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"The same file is available again!"}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"If you are interested in learning more about running your own storage you can check out eg. the following:"}]},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"a","properties":{"href":"https://rook.io/","target":"_blank","rel":["noopener","noreferrer"]},"children":[{"type":"text","value":"Rook"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"a","properties":{"href":"https://openebs.io/","target":"_blank","rel":["noopener","noreferrer"]},"children":[{"type":"text","value":"OpenEBS"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"a","properties":{"href":"https://storageos.com/","target":"_blank","rel":["noopener","noreferrer"]},"children":[{"type":"text","value":"StorageOS"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"a","properties":{"href":"https://longhorn.io/","target":"_blank","rel":["noopener","noreferrer"]},"children":[{"type":"text","value":"Longhorn"}]}]},{"type":"text","value":"\n"}]},{"type":"element","tagName":"exercise","properties":{"name":"Exercise 1.11: Persisting data"},"children":[{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"  Let's share data between \"Ping-pong\" and \"Log output\" applications using persistent volumes. Create both a "},{"type":"element","tagName":"em","properties":{},"children":[{"type":"text","value":"PersistentVolume"}]},{"type":"text","value":" and "},{"type":"element","tagName":"em","properties":{},"children":[{"type":"text","value":"PersistentVolumeClaim"}]},{"type":"text","value":" and alter the "},{"type":"element","tagName":"em","properties":{},"children":[{"type":"text","value":"Deployment"}]},{"type":"text","value":" to utilize it. As PersistentVolumes are often maintained by cluster administrators rather than developers and those are not application-specific you should keep the definition for those separated, perhaps in own folder."}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"  Save the number of requests to \"Ping-pong\" application into a file in the volume and output it with the timestamp and hash when sending a request to our \"Log output\" application. In the end, the two pods should share a persistent volume between the two applications. So the browser should display the following when accessing the \"Log output\" application:"}]},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"plaintext"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-plaintext"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-plaintext"]},"children":[{"type":"text","value":"2020-03-30T12:15:17.705Z: 8523ecb1-c716-4cb6-a044-b9e83bb98e43.\nPing / Pongs: 3"}]}]}]}]},{"type":"element","tagName":"exercise","properties":{"name":"Exercise 1.12: Project v0.6"},"children":[{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"  Since the project looks really boring right now, let's add a picture!"}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"  The goal is to add a daily image to the project. And every day a new image is fetched on the first request."}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"  Get a random picture from Lorem Picsum like "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"https://picsum.photos/1200"}]},{"type":"text","value":" and display it in the project. Find a way to store the image so it stays the same for an entire day."}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"  Make sure to cache the image into a volume so that the API isn't needed for new images every time we access the application or the container crashes."}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"  The best way to test what happens when your container shuts down is likely by shutting down the container, so you can add logic for that as well, for testing purposes."}]}]},{"type":"element","tagName":"exercise","properties":{"name":"Exercise 1.13: Project v0.7"},"children":[{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"  For the project, we'll need to do some coding to start seeing results in the next part."}]},{"type":"element","tagName":"ol","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Add an input field. The input should not take todos that are over 140 characters long."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Add a send button. It does not have to send the todo yet."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Add a list of the existing todos with some hardcoded todos."}]},{"type":"text","value":"\n"}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"  Maybe something similar to this:\n"},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-wrapper"],"style":"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 340px; margin-bottom: 1rem;"},"children":[{"type":"text","value":"\n      "},{"type":"element","tagName":"a","properties":{"className":["gatsby-resp-image-link"],"href":"/static/ff807ebf379aa4fd08d98d96b03d969c/9f933/project-ex-113.png","style":"display: block","target":"_blank","rel":["noopener"]},"children":[{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-background-image"],"style":"padding-bottom: 125.65217391304348%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,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'); background-size: cover; display: block;"},"children":[]},{"type":"text","value":"\n  "},{"type":"element","tagName":"picture","properties":{},"children":[{"type":"text","value":"\n        "},{"type":"element","tagName":"source","properties":{"srcSet":["/static/ff807ebf379aa4fd08d98d96b03d969c/a0b58/project-ex-113.webp 230w","/static/ff807ebf379aa4fd08d98d96b03d969c/8ae5a/project-ex-113.webp 340w"],"sizes":["(max-width:","340px)","100vw,","340px"],"type":"image/webp"},"children":[]},{"type":"text","value":"\n        "},{"type":"element","tagName":"source","properties":{"srcSet":["/static/ff807ebf379aa4fd08d98d96b03d969c/81c8e/project-ex-113.png 230w","/static/ff807ebf379aa4fd08d98d96b03d969c/9f933/project-ex-113.png 340w"],"sizes":["(max-width:","340px)","100vw,","340px"],"type":"image/png"},"children":[]},{"type":"text","value":"\n        "},{"type":"element","tagName":"img","properties":{"className":["gatsby-resp-image-image"],"src":"/static/ff807ebf379aa4fd08d98d96b03d969c/9f933/project-ex-113.png","alt":"project ex 113","title":"project ex 113","loading":"lazy","style":"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"},"children":[]},{"type":"text","value":"\n      "}]},{"type":"text","value":"\n  "}]},{"type":"text","value":"\n    "}]}]}]}]},"html":"<div><text-box variant='learningObjectives' name='Learning Objectives'><p>After this section you</p><ul>\n<li>are able to use volumes to share data between two containers in a pod</li>\n<li>know about persistent volumes to store data on the disk of a node</li>\n</ul></text-box><p>There are two things that are known to be difficult with Kubernetes. First is networking. Thankfully we can avoid most of the networking difficulties unless we were going to setup our own cluster. If you're interested you can watch this Webinar on \"<a href=\"https://www.youtube.com/watch?v=GgCA2USI5iQ\" target=\"_blank\" rel=\"noopener noreferrer\">Kubernetes and Networks: Why is This So Dang Hard?</a>\" but we'll skip most of the topics discussed in the video. The other of the most difficult things is <strong>storage</strong>.</p><p>In part 1 we will look into a very basic method of using storage and return to this topic later. Where almost everything else in Kubernetes is very much dynamic, moving between nodes and replicating with ease, storage does not have the same possibilities. \"<a href=\"https://softwareengineeringdaily.com/2019/01/11/why-is-storage-on-kubernetes-is-so-hard/\" target=\"_blank\" rel=\"noopener noreferrer\">Why Is Storage On Kubernetes So Hard?</a>\" provides us a wide angle on the difficulties and the different options we have to overcome them.</p><p>There are multiple types of volumes and we'll get started with two of them.</p><h3 id=\"volumes\" style=\"position:relative;\">Volumes<a href=\"#volumes\" aria-label=\"volumes permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3><p>A <a href=\"https://docs.docker.com/storage/volumes/\" target=\"_blank\" rel=\"noopener noreferrer\">volume</a> in Docker and Docker compose is the way to persist the data the containers are using. With Kubernetes <a href=\"https://kubernetes.io/docs/concepts/storage/ephemeral-volumes/\" target=\"_blank\" rel=\"noopener noreferrer\">the simple volumes</a> that is not quite the case.</p><p>The Kubernetes volumes, in technical terms <em>emptyDir</em> volumes, are shared filesystems <em>inside a pod</em>, this means that their lifecycle is tied to a pod. When the pod is destroyed the data is lost. In addition, simply moving the pod from another node will destroy the contents of the volume as the space is reserved from the node the pod is running on. So surely you should not use <a href=\"https://kubernetes.io/docs/concepts/storage/volumes/#emptydir\" target=\"_blank\" rel=\"noopener noreferrer\">emptyDir</a>volumes e.g. for backing up a database. Even with the limitations it may be used as a cache as it persists between container restarts or it can be used to share files between two containers in a pod.</p><p>Before we can get started with this, we need an application that shares data with another application. In this case, it will work as a method to share simple log files with each other. We'll need to develop:</p><ul>\n<li>App 1 that will check if /usr/src/app/files/image.jpg exists and if not, it downloads a random image and saves it as image.jpg. Any HTTP request will trigger a new image generation.</li>\n<li>App 2 that will check for the file /usr/src/app/files/image.jpg and shows it, if it is available.</li>\n</ul><p>Apps share a deployment so that both of them are <strong>inside the same pod</strong>. My version is available for you to use <a href=\"https://github.com/kubernetes-hy/material-example/blob/b9ff709b4af7ca13643635e07df7367b54f5c575/app3/manifests/deployment.yaml\" target=\"_blank\" rel=\"noopener noreferrer\">here</a>. The example includes ingress and service to access the application.</p><p><strong>deployment.yaml</strong></p><div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">apiVersion</span><span class=\"token punctuation\">:</span> apps/v1\n<span class=\"token key atrule\">kind</span><span class=\"token punctuation\">:</span> Deployment\n<span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> images<span class=\"token punctuation\">-</span>dep\n<span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">replicas</span><span class=\"token punctuation\">:</span> <span class=\"token number\">1</span>\n  <span class=\"token key atrule\">selector</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">matchLabels</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">app</span><span class=\"token punctuation\">:</span> images\n  <span class=\"token key atrule\">template</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">labels</span><span class=\"token punctuation\">:</span>\n        <span class=\"token key atrule\">app</span><span class=\"token punctuation\">:</span> images\n    <span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">volumes</span><span class=\"token punctuation\">:</span> <span class=\"token comment\"># Define volume</span>\n        <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> shared<span class=\"token punctuation\">-</span>image\n          <span class=\"token key atrule\">emptyDir</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n      <span class=\"token key atrule\">containers</span><span class=\"token punctuation\">:</span>\n        <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> image<span class=\"token punctuation\">-</span>finder\n          <span class=\"token key atrule\">image</span><span class=\"token punctuation\">:</span> jakousa/dwk<span class=\"token punctuation\">-</span>app3<span class=\"token punctuation\">-</span>image<span class=\"token punctuation\">-</span>finder<span class=\"token punctuation\">:</span>b7fc18de2376da80ff0cfc72cf581a9f94d10e64\n          <span class=\"token key atrule\">volumeMounts</span><span class=\"token punctuation\">:</span> <span class=\"token comment\"># Mount volume</span>\n          <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> shared<span class=\"token punctuation\">-</span>image\n            <span class=\"token key atrule\">mountPath</span><span class=\"token punctuation\">:</span> /usr/src/app/files\n        <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> image<span class=\"token punctuation\">-</span>response\n          <span class=\"token key atrule\">image</span><span class=\"token punctuation\">:</span> jakousa/dwk<span class=\"token punctuation\">-</span>app3<span class=\"token punctuation\">-</span>image<span class=\"token punctuation\">-</span>response<span class=\"token punctuation\">:</span>b7fc18de2376da80ff0cfc72cf581a9f94d10e64\n          <span class=\"token key atrule\">volumeMounts</span><span class=\"token punctuation\">:</span> <span class=\"token comment\"># Mount volume</span>\n          <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> shared<span class=\"token punctuation\">-</span>image\n            <span class=\"token key atrule\">mountPath</span><span class=\"token punctuation\">:</span> /usr/src/app/files</code></pre></div><p>As the display is dependent on the volume we can confirm that it works by accessing the image-response and getting the image. The provided ingress used the previously opened port 8081 <a href=\"http://localhost:8081\" target=\"_blank\" rel=\"noopener noreferrer\">http://localhost:8081</a></p><p>Note that all data is lost when the pod goes down.</p><exercise name='Exercise 1.10: Even more services'><p>  Split the \"Log output\" application into two different containers within a single pod:</p><p>  One generates a new timestamp every 5 seconds and saves it into a file.</p><p>  The other reads that file and outputs it with a hash for the user to see.</p><p>  Either application can generate the hash. The reader or the writer.</p><p>  You may find <a href=\"https://kubernetes.io/docs/reference/kubectl/generated/kubectl_logs/\" target=\"_blank\" rel=\"noopener noreferrer\">this</a> helpful now since there are more than one container running inside a pod.</p></exercise><h3 id=\"persistent-volumes\" style=\"position:relative;\">Persistent Volumes<a href=\"#persistent-volumes\" aria-label=\"persistent volumes permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3><p>In contrast to the emptyDir volumes, a <a href=\"https://kubernetes.io/docs/concepts/storage/persistent-volumes/\" target=\"_blank\" rel=\"noopener noreferrer\">Persistent Voulme</a> is something you probably had in mind when we started talking about volumes.</p><p>A Persistent Volume (PV) is a cluster-wide resource, that represents a piece of storage in the cluster that has been provisioned by the cluster administrator or is <a href=\"https://kubernetes.io/docs/concepts/storage/dynamic-provisioning/\" target=\"_blank\" rel=\"noopener noreferrer\">dynamically</a> provisioned. Persistent Volumes can be backed by various types of storage such as local disk, NFS, cloud storage, etc.</p><p>PVs have a lifecycle independent of any individual pod that uses the PV. This means that the data in the PV can outlive the pod that it was attached to.</p><p>When using a cloud provider, such as Google Kubernetes Engine which we shall use in parts 3 and 4, it is the cloud provider that takes care of backing storage and the Persistent Volumes that you can use. If you run your own cluster or use a local cluster such as k3s for development, you need to take care of the storage system and Persistent Volumes by yourself.</p><p>An easy option that we can use with K3s is a <a href=\"https://kubernetes.io/docs/concepts/storage/volumes/#local\" target=\"_blank\" rel=\"noopener noreferrer\">local</a> PersistentVolume that uses a path in a cluster node as the storage. This solution ties the volume to a particular node and if the node becomes unavailable, the storage is not usable.</p><p>So the local Persistent Volumes are <strong>not</strong> the solution to be used in production!</p><p>For the <em>PersistentVolume</em> to work you first need to create the local path in the node we are binding it to. Since our cluster runs via Docker let's create a directory at <code class=\"language-text\">/tmp/kube</code> in the container <code class=\"language-text\">k3d-k3s-default-agent-0</code>. This can simply be done via <code class=\"language-text\">docker exec k3d-k3s-default-agent-0 mkdir -p /tmp/kube</code></p><p>The Persistent Volume definition is created as follows:</p><p><strong>persistentvolume.yaml</strong></p><div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">apiVersion</span><span class=\"token punctuation\">:</span> v1\n<span class=\"token key atrule\">kind</span><span class=\"token punctuation\">:</span> PersistentVolume\n<span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> example<span class=\"token punctuation\">-</span>pv\n<span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">storageClassName</span><span class=\"token punctuation\">:</span> my<span class=\"token punctuation\">-</span>example<span class=\"token punctuation\">-</span>pv <span class=\"token comment\"># this is the name you are using later to claim this volume</span>\n  <span class=\"token key atrule\">capacity</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">storage</span><span class=\"token punctuation\">:</span> 1Gi <span class=\"token comment\"># Could be e.q. 500Gi. Small amount is to preserve space when testing locally</span>\n  <span class=\"token key atrule\">volumeMode</span><span class=\"token punctuation\">:</span> Filesystem <span class=\"token comment\"># This declares that it will be mounted into pods as a directory</span>\n  <span class=\"token key atrule\">accessModes</span><span class=\"token punctuation\">:</span>\n  <span class=\"token punctuation\">-</span> ReadWriteOnce\n  <span class=\"token key atrule\">local</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">path</span><span class=\"token punctuation\">:</span> /tmp/kube\n  <span class=\"token key atrule\">nodeAffinity</span><span class=\"token punctuation\">:</span> <span class=\"token comment\">## This is only required for local, it defines which nodes can access it</span>\n    <span class=\"token key atrule\">required</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">nodeSelectorTerms</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">matchExpressions</span><span class=\"token punctuation\">:</span>\n        <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">key</span><span class=\"token punctuation\">:</span> kubernetes.io/hostname\n          <span class=\"token key atrule\">operator</span><span class=\"token punctuation\">:</span> In\n          <span class=\"token key atrule\">values</span><span class=\"token punctuation\">:</span>\n          <span class=\"token punctuation\">-</span> k3d<span class=\"token punctuation\">-</span>k3s<span class=\"token punctuation\">-</span>default<span class=\"token punctuation\">-</span>agent<span class=\"token punctuation\">-</span><span class=\"token number\">0</span></code></pre></div><p><a href=\"https://kubernetes.io/docs/concepts/storage/persistent-volumes/\" target=\"_blank\" rel=\"noopener noreferrer\">Persistent Volume Claim</a> (PVC) is a request for storage by a user.</p><p>When a user creates a PVC, Kubernetes finds an appropriate PV that satisfies the claim's requirements and binds them together. If no PV is available, depending on the configuration, the cluster might dynamically create a PV that meets the claim's needs.</p><p>Once bound, the PersistentVolumeClaim is \"locked\" and can only be used by one Pod (depending on the access mode specified). This ensures that the PV resource is exclusively used by the pod it's bound to.</p><p>If there is no suitable Persistent Volume available, the PVC will stay in the \"Pending\" state, waiting for a suitable PV.</p><p>Conceptually, you can think of PVs as the physical volume (the actual storage in your infrastructure), whereas PVCs are the means by which pods claim this storage for their use.</p><p>Let us now create a claim for our app:</p><p><strong>persistentvolumeclaim.yaml</strong></p><div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">apiVersion</span><span class=\"token punctuation\">:</span> v1\n<span class=\"token key atrule\">kind</span><span class=\"token punctuation\">:</span> PersistentVolumeClaim\n<span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> image<span class=\"token punctuation\">-</span>claim <span class=\"token comment\"># name of ther volume claim, this will be used in the deployment</span>\n<span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">storageClassName</span><span class=\"token punctuation\">:</span> my<span class=\"token punctuation\">-</span>example<span class=\"token punctuation\">-</span>pv <span class=\"token comment\"># this is the name of the persisten volume we are claiming</span>\n  <span class=\"token key atrule\">accessModes</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">-</span> ReadWriteOnce\n  <span class=\"token key atrule\">resources</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">requests</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">storage</span><span class=\"token punctuation\">:</span> 1Gi</code></pre></div><p>Modify the previously introduced deployment to use it:</p><p><strong>deployment.yaml</strong></p><div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token comment\"># ...</span>\n    <span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">volumes</span><span class=\"token punctuation\">:</span>\n        <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> shared<span class=\"token punctuation\">-</span>image\n          <span class=\"token key atrule\">persistentVolumeClaim</span><span class=\"token punctuation\">:</span>\n            <span class=\"token key atrule\">claimName</span><span class=\"token punctuation\">:</span> image<span class=\"token punctuation\">-</span>claim\n      <span class=\"token key atrule\">containers</span><span class=\"token punctuation\">:</span>\n        <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> image<span class=\"token punctuation\">-</span>finder\n          <span class=\"token key atrule\">image</span><span class=\"token punctuation\">:</span> jakousa/dwk<span class=\"token punctuation\">-</span>app3<span class=\"token punctuation\">-</span>image<span class=\"token punctuation\">-</span>finder<span class=\"token punctuation\">:</span>b7fc18de2376da80ff0cfc72cf581a9f94d10e64\n          <span class=\"token key atrule\">volumeMounts</span><span class=\"token punctuation\">:</span>\n          <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> shared<span class=\"token punctuation\">-</span>image\n            <span class=\"token key atrule\">mountPath</span><span class=\"token punctuation\">:</span> /usr/src/app/files\n        <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> image<span class=\"token punctuation\">-</span>response\n          <span class=\"token key atrule\">image</span><span class=\"token punctuation\">:</span> jakousa/dwk<span class=\"token punctuation\">-</span>app3<span class=\"token punctuation\">-</span>image<span class=\"token punctuation\">-</span>response<span class=\"token punctuation\">:</span>b7fc18de2376da80ff0cfc72cf581a9f94d10e64\n          <span class=\"token key atrule\">volumeMounts</span><span class=\"token punctuation\">:</span>\n          <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> shared<span class=\"token punctuation\">-</span>image\n            <span class=\"token key atrule\">mountPath</span><span class=\"token punctuation\">:</span> /usr/src/app/files</code></pre></div><p>And apply it with persistentvolume.yaml and persistentvolumeclaim.yaml.</p><div class=\"gatsby-highlight\" data-language=\"console\"><pre class=\"language-console\"><code class=\"language-console\">$ kubectl apply -f https://raw.githubusercontent.com/kubernetes-hy/material-example/master/app3/manifests/deployment-persistent.yaml</code></pre></div><p>With the previous service and ingress, we can access the app in <a href=\"http://localhost:8081\" target=\"_blank\" rel=\"noopener noreferrer\">http://localhost:8081</a>. To confirm that the data is persistent we can run</p><div class=\"gatsby-highlight\" data-language=\"console\"><pre class=\"language-console\"><code class=\"language-console\">$ kubectl delete -f https://raw.githubusercontent.com/kubernetes-hy/material-example/master/app3/manifests/deployment-persistent.yaml\n  deployment.apps &quot;images-dep&quot; deleted\n$ kubectl apply -f https://raw.githubusercontent.com/kubernetes-hy/material-example/master/app3/manifests/deployment-persistent.yaml\n  deployment.apps/images-dep created</code></pre></div><p>The same file is available again!</p><p>If you are interested in learning more about running your own storage you can check out eg. the following:</p><ul>\n<li><a href=\"https://rook.io/\" target=\"_blank\" rel=\"noopener noreferrer\">Rook</a></li>\n<li><a href=\"https://openebs.io/\" target=\"_blank\" rel=\"noopener noreferrer\">OpenEBS</a></li>\n<li><a href=\"https://storageos.com/\" target=\"_blank\" rel=\"noopener noreferrer\">StorageOS</a></li>\n<li><a href=\"https://longhorn.io/\" target=\"_blank\" rel=\"noopener noreferrer\">Longhorn</a></li>\n</ul><exercise name='Exercise 1.11: Persisting data'><p>  Let's share data between \"Ping-pong\" and \"Log output\" applications using persistent volumes. Create both a <em>PersistentVolume</em> and <em>PersistentVolumeClaim</em> and alter the <em>Deployment</em> to utilize it. As PersistentVolumes are often maintained by cluster administrators rather than developers and those are not application-specific you should keep the definition for those separated, perhaps in own folder.</p><p>  Save the number of requests to \"Ping-pong\" application into a file in the volume and output it with the timestamp and hash when sending a request to our \"Log output\" application. In the end, the two pods should share a persistent volume between the two applications. So the browser should display the following when accessing the \"Log output\" application:</p><div class=\"gatsby-highlight\" data-language=\"plaintext\"><pre class=\"language-plaintext\"><code class=\"language-plaintext\">2020-03-30T12:15:17.705Z: 8523ecb1-c716-4cb6-a044-b9e83bb98e43.\nPing / Pongs: 3</code></pre></div></exercise><exercise name='Exercise 1.12: Project v0.6'><p>  Since the project looks really boring right now, let's add a picture!</p><p>  The goal is to add a daily image to the project. And every day a new image is fetched on the first request.</p><p>  Get a random picture from Lorem Picsum like <code class=\"language-text\">https://picsum.photos/1200</code> and display it in the project. Find a way to store the image so it stays the same for an entire day.</p><p>  Make sure to cache the image into a volume so that the API isn't needed for new images every time we access the application or the container crashes.</p><p>  The best way to test what happens when your container shuts down is likely by shutting down the container, so you can add logic for that as well, for testing purposes.</p></exercise><exercise name='Exercise 1.13: Project v0.7'><p>  For the project, we'll need to do some coding to start seeing results in the next part.</p><ol>\n<li>Add an input field. The input should not take todos that are over 140 characters long.</li>\n<li>Add a send button. It does not have to send the todo yet.</li>\n<li>Add a list of the existing todos with some hardcoded todos.</li>\n</ol><p>  Maybe something similar to this:\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 340px; margin-bottom: 1rem;\">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/ff807ebf379aa4fd08d98d96b03d969c/9f933/project-ex-113.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 125.65217391304348%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,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&apos;); background-size: cover; display: block;\"></span>\n  <picture>\n        <source srcset=\"/static/ff807ebf379aa4fd08d98d96b03d969c/a0b58/project-ex-113.webp 230w,\n/static/ff807ebf379aa4fd08d98d96b03d969c/8ae5a/project-ex-113.webp 340w\" sizes=\"(max-width: 340px) 100vw, 340px\" type=\"image/webp\">\n        <source srcset=\"/static/ff807ebf379aa4fd08d98d96b03d969c/81c8e/project-ex-113.png 230w,\n/static/ff807ebf379aa4fd08d98d96b03d969c/9f933/project-ex-113.png 340w\" sizes=\"(max-width: 340px) 100vw, 340px\" type=\"image/png\">\n        <img class=\"gatsby-resp-image-image\" src=\"/static/ff807ebf379aa4fd08d98d96b03d969c/9f933/project-ex-113.png\" alt=\"project ex 113\" title=\"project ex 113\" loading=\"lazy\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\">\n      </picture>\n  </a>\n    </span></p></exercise></div>","frontmatter":{"path":"/part-1/4-introduction-to-storage","title":"Introduction to Storage"},"fileAbsolutePath":"/home/runner/work/kubernetes-hy.github.io/kubernetes-hy.github.io/data/part-1/4-introduction-to-storage.md"},"allPages":{"edges":[{"node":{"id":"e4e5fe1c-25b1-57b3-87eb-e204e767a49c","frontmatter":{"path":"/faq","title":"FAQ"}}},{"node":{"id":"9f6e26aa-46a9-523d-96e4-a57c65ec083d","frontmatter":{"path":"/frontmatter-guide","title":"Frontmatter-guide"}}},{"node":{"id":"ecaa7011-87db-5ece-9b3c-1cfad638324a","frontmatter":{"path":"/","title":"Homepage"}}},{"node":{"id":"3d7eac33-2990-59d1-a002-64e0b0f4f370","frontmatter":{"path":"/known-problems-solutions","title":"Issues you may face"}}},{"node":{"id":"fb4fb717-329a-5d49-94c3-183aa16507e2","frontmatter":{"path":"/unity-assignment","title":"Unity Assignment"}}},{"node":{"id":"57c61ed7-37c4-5d0f-acd8-1dca0de6be4a","frontmatter":{"path":"/registration-and-completion","title":"Registration and Completion"}}},{"node":{"id":"8ecc11b1-3298-589e-b97a-2a3a36861b8d","frontmatter":{"path":"/sanasto","title":"Sanasto"}}},{"node":{"id":"dab4b6a7-96cf-5efe-83f4-f5199c283e65","frontmatter":{"path":"/part-0","title":"Part 0"}}},{"node":{"id":"78948204-39a7-5f81-b9f4-3029400d5f82","frontmatter":{"path":"/part-1/2-introduction-to-debugging","title":"Introduction to Debugging"}}},{"node":{"id":"0b237cfb-5f2a-5d8e-9aa0-0cf9b045db3a","frontmatter":{"path":"/part-1/5-summary","title":"Summary"}}},{"node":{"id":"fe4a80ee-85ba-536e-bbf5-c5695399f40f","frontmatter":{"path":"/part-1","title":"Part 1"}}},{"node":{"id":"9e4ff8d0-2e6c-5d55-83a0-16ada460096d","frontmatter":{"path":"/part-2/2-organizing-a-cluster","title":"Organizing a cluster"}}},{"node":{"id":"19841be9-897c-577a-9f82-5a7381bc073c","frontmatter":{"path":"/part-2/1-networking-between-pods","title":"Networking between pods"}}},{"node":{"id":"f802a4ea-8d5a-503f-ad7b-d0138ab84c80","frontmatter":{"path":"/part-2/6-summary","title":"Summary"}}},{"node":{"id":"56f2a7a2-c9e2-5bbb-b6a7-76fd46592c69","frontmatter":{"path":"/part-2/5-monitoring","title":"Monitoring"}}},{"node":{"id":"b810e0d9-0ac2-5073-a9dc-4ffd6649b7f7","frontmatter":{"path":"/part-2","title":"Part 2"}}},{"node":{"id":"40440141-c1a8-5723-858a-eea86119b5b6","frontmatter":{"path":"/part-3/4-summary","title":"Summary"}}},{"node":{"id":"708df9d2-30d1-518f-8066-80109a75c4dc","frontmatter":{"path":"/part-3","title":"Part 3"}}},{"node":{"id":"47a288aa-ece4-5ba6-ab6e-cbc63dbdc752","frontmatter":{"path":"/part-4/4-summary","title":"Summary"}}},{"node":{"id":"8a2e40fa-1703-5755-aa66-ac69bf2e291d","frontmatter":{"path":"/part-5/3-service-mesh","title":"Service Mesh"}}},{"node":{"id":"c8b1eb5e-3c98-59b3-b6e9-6173791d7e34","frontmatter":{"path":"/part-4","title":"Part 4"}}},{"node":{"id":"7bebb01b-c990-5e7e-a9aa-d60f10ba63dd","frontmatter":{"path":"/part-5/5-summary","title":"Summary and end"}}},{"node":{"id":"fd6ebeaa-c808-5f11-9bdc-30e4f69b8a2a","frontmatter":{"path":"/part-1/4-introduction-to-storage","title":"Introduction to Storage"}}},{"node":{"id":"e4c53dca-867f-5293-9b28-657b695cd3f3","frontmatter":{"path":"/part-1/3-introduction-to-networking","title":"Introduction to Networking"}}},{"node":{"id":"0353d158-f751-57fd-94ce-373924da1b05","frontmatter":{"path":"/part-2/3-configuring-applications","title":"Configuring applications"}}},{"node":{"id":"eae6660d-1d18-527a-bc1c-0f2f7ab54c6d","frontmatter":{"path":"/part-2/4-statefulsets-and-jobs","title":"StatefulSets and Jobs"}}},{"node":{"id":"e80b74e8-a23b-5d3c-808b-833a72ac739c","frontmatter":{"path":"/part-3/2-deployment-pipeline","title":"Deployment Pipeline"}}},{"node":{"id":"9f3c6f02-668a-517b-b7b6-1828f74c7200","frontmatter":{"path":"/part-3/1-introduction-to-gke","title":"Introduction to Google Kubernetes Engine"}}},{"node":{"id":"78f84327-bd7b-5b5d-941d-9fae8bca88d3","frontmatter":{"path":"/part-3/3-gke-features","title":"GKE features"}}},{"node":{"id":"f5314214-d779-5fb4-a19f-ab7442f3fbb2","frontmatter":{"path":"/part-4/2-messaging-systems","title":"Messaging Systems"}}},{"node":{"id":"0a2d8cfd-8e40-59a7-a688-e8bdc9fb9e3a","frontmatter":{"path":"/part-4/3-gitops","title":"GitOps"}}},{"node":{"id":"39fb03b7-2abe-515a-a543-b812fcbfdba5","frontmatter":{"path":"/part-5/1-kubernetes-internals","title":"Kubernetes Internals"}}},{"node":{"id":"a899eeb2-4329-5c9b-aadf-2fb803fa9142","frontmatter":{"path":"/part-5/2-custom-resource-definitions","title":"Custom Resource Definitions"}}},{"node":{"id":"471982cb-da12-5799-a6b2-fa8a3e67aa0d","frontmatter":{"path":"/part-5/4-beyond-kubernetes","title":"Beyond Kubernetes"}}},{"node":{"id":"cbd58376-8d52-5297-b38d-653179a1226f","frontmatter":{"path":"/part-5","title":"Part 5"}}},{"node":{"id":"33c86b5c-3684-5006-b4e7-dbd0c7cc04bc","frontmatter":{"path":"/part-4/1-update-strategies-and-prometheus","title":"Update Strategies and Prometheus"}}},{"node":{"id":"da15a80e-5316-5986-afcf-75d521065017","frontmatter":{"path":"/part-1/1-first-deploy","title":"First Deploy"}}}]}},"pageContext":{}},"staticQueryHashes":["3294351120","994120085"]}